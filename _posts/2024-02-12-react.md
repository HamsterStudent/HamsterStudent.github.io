---
layout: post
title: "ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ë·° ë¡œì§ ë¶„ë¦¬í•˜ê¸°"
date: 2024-02-12
last_modified_at: 2024-02-12
categories: [React]
---

# ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë¶„ë¦¬í•˜ê¸°

### shipping.tsx

```tsx
export default function Shipping() {
  const shippingAddress = useSelector(
    (state: IRootState) => state.cart.shippingAddress,
  );
  const {
    handleSubmit,
    register,
    formState: { errors },
    setValue,
  } = useForm<IAddress>();
  const router = useRouter();
  const dispatch = useDispatch();

  const [showAddressModal, setShowAddressModal] = useState(false);
  const [zipCode, setZipcode] = useState<string>("");
  const [roadAddress, setRoadAddress] = useState<string>("");

  const completeHandler = (data: Address) => {
    setZipcode(data.zonecode);
    setRoadAddress(data.roadAddress);
    setShowAddressModal(false);
  };

  useEffect(() => {
    if (!shippingAddress) return;
    setValue("fullName", shippingAddress.fullName);
    setValue("number", shippingAddress.number);
    setValue("email", shippingAddress.email);
    setValue("address", shippingAddress.address);
    setValue("detailAddress", shippingAddress.detailAddress);
    setValue("postalCode", shippingAddress.postalCode);
  }, [setValue, shippingAddress]);

  const submitHandler = ({
    fullName,
    number,
    email,
    address,
    detailAddress,
    postalCode,
  }: IAddress) => {
    dispatch(
      saveShippingAddress({
        fullName,
        number,
        email,
        address,
        detailAddress,
        postalCode,
      }),
    );
    router.push("/payment");
  };

  return (
    <div>
      {showAddressModal ? (
        <ModalWrap>
          <Modal>
            <DaumPostcode onComplete={completeHandler} />
          </Modal>
        </ModalWrap>
      ) : null}
      <CheckoutWizard activeStep={1} />
      <form onSubmit={handleSubmit(submitHandler)}>
        <h1>ë°°ì†¡ ì •ë³´</h1>
        <ul>{/* input listë“¤ ...*/}</ul>
        <div>
          <button>Next</button>
        </div>
      </form>
    </div>
  );
}
```

<aside>
ğŸš§ ì´ í˜ì´ì§€ì—ì„œ ìˆ˜í–‰í•˜ê³  ì‹¶ì—ˆë˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì´ë ‡ìŠµë‹ˆë‹¤.

- ì‚¬ìš©ìë¡œë¶€í„° ë°°ì†¡ ì •ë³´ë¥¼ ë°›ëŠ”ë‹¤(ì´ë¦„, ì´ë©”ì¼, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ ë“±)
  - ì£¼ì†Œ ì •ë³´ë¥¼ ë°›ì„ ë•Œì—ëŠ” ìƒˆë¡œ ëª¨ë‹¬ì°½ì„ ì—´ì–´ ë°ì´í„°ë¥¼ ë°›ì•„ ì˜¨ë‹¤
  - ë§Œì•½ ì…ë ¥í–ˆë˜ ë°°ì†¡ ì •ë³´ê°€ ì´ë¯¸ ìˆì—ˆë‹¤ë©´, ì „ì—­ ìƒíƒœì—ì„œ ê·¸ ì •ë³´ë¥¼ ë°›ì•„ì™€ inputì— ì…ë ¥í•œë‹¤.
- next ë²„íŠ¼ í´ë¦­ ì‹œ, ì‚¬ìš©ìë¡œë¶€í„° ë°›ì€ ì •ë³´ë¥¼ ì „ì—­ ìƒíƒœë¡œ ì €ì¥í•˜ê³  ë‹¤ìŒ í˜ì´ì§€ë¡œ ë„˜ê¸´ë‹¤
</aside>

ì½”ë“œë§Œ ë³´ì•˜ì„ ë•Œ, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì¸ì§€ ì•„ë‹Œì§€ êµ¬ë¶„í•˜ëŠ” ì‘ì—…ì´ ì–´ë ¤ì› ê¸° ë•Œë¬¸ì—,

<**[í”„ë¡ íŠ¸ì—”ë“œ ì•„í‚¤í…ì²˜: Business Logicì˜ ë¶„ë¦¬](https://medium.com/@junep/í”„ë¡ íŠ¸ì—”ë“œ-ì•„í‚¤í…ì²˜-business-logicì˜-ë¶„ë¦¬-adc10ae881ab)>**

ê²Œì‹œê¸€ì„ ì°¸ê³ í•´ ê°€ë©° ë¶„ë¦¬í•˜ë ¤ê³  í•´ ë³´ì•˜ëŠ”ë°ìš”, ìš°ì„  ë·° ë¡œì§ì— í•´ë‹¹í•˜ëŠ” ê²ƒë“¤ì„ ë¶„ë¦¬í•´ ë‚´ëŠ” ì‘ì—…ì„ í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.

```tsx
export default function Shipping() {

  const [showAddressModal, setShowAddressModal] = useState(false);

	const [zipCode, setZipcode] = useState<string>("");
	const [roadAddress, setRoadAddress] = useState<string>("");

  const completeHandler = (data: Address) => {
    //...
    setShowAddressModal(false);
  };

  const submitHandler = ({
    //...
  };

  return (
    <div>
      {showAddressModal ? (
        <ModalWrap>
          <Modal>
            <DaumPostcode onComplete={completeHandler} />
          </Modal>
        </ModalWrap>
      ) : null}
      <CheckoutWizard activeStep={1} />
      <form onSubmit={handleSubmit(submitHandler)}>
        <h1>ë°°ì†¡ ì •ë³´</h1>
        <ul>
          {/* input listë“¤ ...*/}
        </ul>
        <div>
          <button>Next</button>
        </div>
      </form>
    </div>
  );
}
```

ë·° ë¡œì§ì„ ë¶„ë¦¬í•˜ê³  ë‚¨ì€ ì½”ë“œë“¤ ì…ë‹ˆë‹¤.

```tsx
const shippingAddress = useSelector(
  (state: IRootState) => state.cart.shippingAddress,
);
const {
  handleSubmit,
  register,
  formState: { errors },
  setValue,
} = useForm<IAddress>();
const router = useRouter();
const dispatch = useDispatch();

useEffect(() => {
  if (!shippingAddress) return;
  setValue("fullName", shippingAddress.fullName);
  setValue("number", shippingAddress.number);
  setValue("email", shippingAddress.email);
  setValue("address", shippingAddress.address);
  setValue("detailAddress", shippingAddress.detailAddress);
  setValue("postalCode", shippingAddress.postalCode);
}, [setValue, shippingAddress]);

const submitHandler = ({
  fullName,
  number,
  email,
  address,
  detailAddress,
  postalCode,
}: IAddress) => {
  dispatch(
    saveShippingAddress({
      fullName,
      number,
      email,
      address,
      detailAddress,
      postalCode,
    }),
  );
  router.push("/payment");
};
```

ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ ì½”ë“œë“¤ì„ í•˜ë‚˜ì”© ì‚´í´ë³´ë©´,

- ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì˜ ìš”ì†Œë“¤ì„ êº¼ë‚´ì˜¤ëŠ” ë³€ìˆ˜
- ë¼ìš°í„° ì„ ì–¸, dispatch ì„ ì–¸
- ì£¼ì†Œì°½ ëª¨ë‹¬ì˜ ì½œë°± í•¨ìˆ˜
- í˜ì´ì§€ ì§„ì… ì‹œ, inputì— ë°ì´í„°ë¥¼ ë‹´ëŠ” ê¸°ëŠ¥
- useformì˜ hadleSubmitì˜ ì½œë°± í•¨ìˆ˜(ê²Œë‹¤ê°€ ë¹„ìŠ·í•œ ì´ë¦„ì˜ í•¨ìˆ˜ë„ ë§Œë“¤ì—ˆë„¤ìš”)

<aside>
ğŸš§ ì´ í˜ì´ì§€ì—ì„œ ìˆ˜í–‰í•˜ê³  ì‹¶ì—ˆë˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì´ë ‡ìŠµë‹ˆë‹¤.

- ì‚¬ìš©ìë¡œë¶€í„° ë°°ì†¡ ì •ë³´ë¥¼ ë°›ëŠ”ë‹¤(ì´ë¦„, ì´ë©”ì¼, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ ë“±)
  - ì£¼ì†Œ ì •ë³´ë¥¼ ë°›ì„ ë•Œì—ëŠ” ìƒˆë¡œ ëª¨ë‹¬ì°½ì„ ì—´ì–´ ë°ì´í„°ë¥¼ ë°›ì•„ ì˜¨ë‹¤
  - ë§Œì•½ ì…ë ¥í–ˆë˜ ë°°ì†¡ ì •ë³´ê°€ ì´ë¯¸ ìˆì—ˆë‹¤ë©´, ì „ì—­ ìƒíƒœì—ì„œ ê·¸ ì •ë³´ë¥¼ ë°›ì•„ì™€ inputì— ì…ë ¥í•œë‹¤.
- next ë²„íŠ¼ í´ë¦­ ì‹œ, ì‚¬ìš©ìë¡œë¶€í„° ë°›ì€ ì •ë³´ë¥¼ ì „ì—­ ìƒíƒœë¡œ ì €ì¥í•˜ê³  ë‹¤ìŒ í˜ì´ì§€ë¡œ ë„˜ê¸´ë‹¤
</aside>

ì•ì„œ ë§í–ˆë˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ â€¦ â€¦ ì–´ì§€ëŸ½ê²Œ ì§€í‚¤ê³  ìˆìŠµë‹ˆë‹¤. ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©ì´ ë§ì•„ì§€ë©´ì„œ ì´ìƒí•œ ì½”ë“œ ë­‰ì¹˜ê°€ ë˜ì—ˆë„¤ìš”. ì—¬ê¸°ì„œ **ì˜ì¡´ì„± ì—­ì „ ì›ì¹™**ì„ ìƒê°í•´ ë³¸ë‹¤ë©´, ì–´ë–¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë³€ê²½í•˜ë˜ ê°„ì— ê¸°ëŠ¥ì´ ë˜‘ê°™ì´ ë™ì‘í•˜ê²Œ í•´ì•¼ í•˜ê³ , ì¤‘ê°„ ë™ì‘ì€ ìˆ˜ì •ì„ ê°€í•  í•„ìš”ê°€ ì—†ì–´ì•¼ í•©ë‹ˆë‹¤. ì €ëŠ” apië¥¼ fetchí•´ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê²ƒì´ë¼ê³  ì´í•´í–ˆì–´ìš”.

- ì‚¬ìš©ìë¡œë¶€í„° ë°°ì†¡ ì •ë³´ë¥¼ ë°›ëŠ”ë‹¤(ì´ë¦„, ì´ë©”ì¼, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ ë“±)
  - ë§Œì•½ ì…ë ¥í–ˆë˜ ë°°ì†¡ ì •ë³´ê°€ ì´ë¯¸ ìˆì—ˆë‹¤ë©´, ì „ì—­ ìƒíƒœì—ì„œ ê·¸ ì •ë³´ë¥¼ ë°›ì•„ì™€ inputì— ì…ë ¥í•œë‹¤.

```tsx
const fetchInitialAddress = (array: (keyof IAddress)[]) => {
  if (!shippingAddress) return;
  array.map((x) => {
    setValue(x, shippingAddress[x]);
  });
};

useEffect(() => {
  fetchInitialAddress([
    "fullName",
    "number",
    "email",
    "address",
    "postalCode",
    "detailAddress",
  ]);
}, [shippingAddress]);
```

ì „ì—­ ìƒíƒœë¥¼ ë°›ì•„ì˜¤ëŠ” ë³€ìˆ˜ì˜ ìœ ë¬´ë¥¼ í™•ì¸í•˜ê³  â†’ ê·¸ ê°’ë“¤ì„ setValueë¥¼ ì‚¬ìš©í•´ ê° inputì— ë„£ì„ ìˆ˜ ìˆê²Œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì¶”í›„ useFormì„ êµì²´í•˜ê²Œ ë  ìƒí™©ì—ì„œëŠ” fetchInitialAddressë§Œ í™•ì¸í•˜ë©´ ë˜ê² ì£ ?

- next ë²„íŠ¼ í´ë¦­ ì‹œ, ì‚¬ìš©ìë¡œë¶€í„° ë°›ì€ ì •ë³´ë¥¼ ì „ì—­ ìƒíƒœë¡œ ì €ì¥í•˜ê³  ë‹¤ìŒ í˜ì´ì§€ë¡œ ë„˜ê¸´ë‹¤

```tsx
const saveShippingDataWithRedux = (data: IAddress) => {
  dispatch(saveShippingAddress(data));
};

const formDataFromUseForm = (): IAddress => {
  const {
    fullName,
    number,
    email,
    address,
    postalCode,
    detailAddress,
  }: IAddress = getValues();
  return { fullName, number, email, address, postalCode, detailAddress };
};

const submitHandler = () => {
  const formData = formDataFromUseForm();
  saveShippingDataWithRedux(formData);
  router.push("/payment");
};
```

reduxì˜ ë™ì‘ê³¼ useForm ì´ ë‘ ê°€ì§€ì˜ ì •ë³´ë¥¼ ë°›ì•„ì™€ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ” ì‘ì—…ì´ì—ˆê¸° ë•Œë¬¸ì—, ê°ê° ìˆ˜í–‰í•˜ëŠ” ë¶€ë¶„ì„ ë¶„ë¦¬í•˜ëŠ” ì‘ì—…ì„ í–ˆìŠµë‹ˆë‹¤. ë§Œì•½ useFormì´ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ êµì²´ë˜ë”ë¼ë„, ì „ì—­ ìƒíƒœ ê´€ë¦¬ íˆ´ì—ëŠ” `{ fullName, number, email, address, postalCode, detailAddress }`ì— í•´ë‹¹í•˜ëŠ” ê°’ë“¤ë§Œ ë„£ì–´ì£¼ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.

`submitHandler`ëŠ” ì´ì œ 1. í¼ì˜ ë°ì´í„°ë“¤ì„ ë°›ì•„ì˜¤ê³  2. í¼ì˜ ìƒíƒœë¥¼ ì €ì¥í•˜ê³  3. paymentë¥¼ ì„ íƒí•˜ëŠ” í˜ì´ì§€ë¡œ ì‚¬ìš©ìë¥¼ ë³´ëƒ…ë‹ˆë‹¤. êµ¬ì²´ì ì¸ ë¡œì§ì€ ê° `formDataFromUseForm`ê³¼ `saveShippingDataWithRedux`ê°€ ìˆ˜í–‰ í•  ê²ƒ ì…ë‹ˆë‹¤.

- ì‚¬ìš©ìë¡œë¶€í„° ë°°ì†¡ ì •ë³´ë¥¼ ë°›ëŠ”ë‹¤(ì´ë¦„, ì´ë©”ì¼, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ ë“±)
  - ì£¼ì†Œ ì •ë³´ë¥¼ ë°›ì„ ë•Œì—ëŠ” ìƒˆë¡œ ëª¨ë‹¬ì°½ì„ ì—´ì–´ ë°ì´í„°ë¥¼ ë°›ì•„ ì˜¨ë‹¤

```tsx
const completeHandler = (data: Address) => {
	setValue("postalCode", data.zonecode);
  setValue("address", data.roadAddress);
  setShowAddressModal(false);
};

return (
	....
	<Dialog isOpen={showAddressModal}>
	    <Dialog.Dimmed />
	    <Dialog.Content>
		    <Dialog.Title>Hamster is Good</Dialog.Title>
		    <DaumPostcode onComplete={completeHandler} />
	    </Dialog.Content>
	</Dialog>
	....
)
```

ëª¨ë‹¬ì°½ì€ ë‹¤ë¥¸ í˜ì´ì§€ì—ì„œë„ ì“¸ ì˜ˆì •ì´ê¸° ë•Œë¬¸ì—, CCP íŒ¨í„´ìœ¼ë¡œ êµ¬ì„±í•´, **ê°œë°©-íì‡„ ì›ì¹™**ì„ ì§€í‚¤ë ¤ê³  í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. onCompleteì—ëŠ” ëª¨ë‹¬ ì°½ closeì‹œ ìˆ˜í–‰í•  ì½œë°±í•¨ìˆ˜ë¥¼ ë„£ì—ˆìŠµë‹ˆë‹¤. ì‘ì„±í•˜ê³  ë³´ë‹ˆ ì´ìƒí•œ ì ì´ ìˆë„¤ìš”.

```tsx
const completeHandler = (data: Address) => {
  setValue("postalCode", data.zonecode);
  setValue("address", data.roadAddress);
  setShowAddressModal(false);
};

const fetchInitialAddress = (array: (keyof IAddress)[]) => {
  if (!shippingAddress) return;
  array.map((x) => {
    setValue(x, shippingAddress[x]);
  });
};
```

`completeHandler`ì—ì„œ `fetchInitialAddress`ì—ì„œ ë°›ì•„ì˜¤ëŠ” ê°ì²´ë§Œ ë‹¤ë¥¼ ë¿ ê°™ì€ ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ê·¸ëŸ°ë° `completeHandler` ë‚´ë¶€ì—ì„œ `fetchInitialAddress`ë¥¼ ì‚¬ìš©í•  ìˆ˜ê°€ ì—†ë„¤ìš”. ë­”ê°€ ë¶„ë¦¬ë¥¼ ì˜ëª» í–ˆë‹¤ëŠ” ê²ë‹ˆë‹¤

```tsx
const setInputValueFromUseForm = (
  array: (keyof IAddress)[],
  data: IAddress | Address,
) => {
  if ("zonecode" in data) {
    const { zonecode, roadAddress } = data;
    setValue(array[0], zonecode);
    setValue(array[1], roadAddress);
  } else if ("fullName" in data) {
    array.map((x) => {
      setValue(x, shippingAddress[x]);
    });
  }
};
```

ê·¸ë˜ì„œ ë°°ì—´ê³¼ ë°ì´í„°ë¥¼ ì–»ì–´ ë‚´ë¶€ì—ì„œ ë¶„ê¸°ì²˜ë¦¬ë¥¼ í•´ì„œ ë°ì´í„°ë¥¼ inputì— ë„£ì„ ìˆ˜ ìˆë„ë¡ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì•”ë¬µì  ì¸ìë¥¼ ëª…ì‹œì  ì¸ìë¡œ ë³€ê²½í•˜ì—¬, ì–´ë–¤ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì„œ ì–´ë–¤ ê°’ì„ ë„£ëŠ” ì§€ì— ëŒ€í•´ì„œë„ ì•Œ ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. useForm ì œì™¸í•˜ê³ ëŠ” ë‹¤ë¥¸ ì™¸ë¶€ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì§€ë„ ì•ŠìŠµë‹ˆë‹¤!

```tsx
// useSelector //
const shippingAddress = useSelector(
  (state: IRootState) => state.cart.shippingAddress,
);
// useSelector //
const {
  handleSubmit,
  register,
  formState: { errors },
  setValue,
  getValues,
} = useForm<IAddress>();
const router = useRouter();
const dispatch = useDispatch();
const [showAddressModal, setShowAddressModal] = useState(false);
const inputList: (keyof IAddress)[] = [
  "fullName",
  "number",
  "email",
  "address",
  "postalCode",
  "detailAddress",
];

useEffect(() => {
  setInputValueFromUseForm(inputList, shippingAddress);
}, [shippingAddress]);

const addressCompleteHandler = (data: Address) => {
  setInputValueFromUseForm(["postalCode", "address"], data);
  setShowAddressModal(false);
};

const setInputValueFromUseForm = (
  array: (keyof IAddress)[],
  data: IAddress | Address,
) => {
  if ("zonecode" in data) {
    const { zonecode, roadAddress } = data;
    setValue(array[0], zonecode);
    setValue(array[1], roadAddress);
  } else if ("fullName" in data) {
    array.map((x) => {
      setValue(x, data[x]);
    });
  }
};

const formDataFromUseForm = (): IAddress => {
  const {
    fullName,
    number,
    email,
    address,
    postalCode,
    detailAddress,
  }: IAddress = getValues();
  return { fullName, number, email, address, postalCode, detailAddress };
};

const saveShippingDataWithRedux = (data: IAddress) => {
  dispatch(saveShippingAddress(data));
};

const submitHandler = () => {
  const formData = formDataFromUseForm();
  saveShippingDataWithRedux(formData);
  router.push("/payment");
};
```

ì´ë ‡ê²Œ ê°ìê°€ ìˆ˜í–‰í•˜ëŠ” ë°”ë¥¼ ëª…í™•íˆ ì•Œ ìˆ˜ ìˆë„ë¡ í•¨ìˆ˜ ì´ë¦„ìœ¼ë¡œ ëª…ì‹œí•˜ê³ , ê¸°ëŠ¥ì„ ë¶„ë¦¬í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤.
